Service Exploits


Service Commands:

Query the configuration		sc.exe qc <name>

Query the current status 	sc.exe query <name>

Modify a configuration option	sc.exe config <name> <option>= <value>

Start/Stop a service:		net start/stop <name>


Types:

1. Insecure Service Properties
2. Unquoted Service Path
3. Weak Registry Permissions
4. Insecure Service Executables
5. DLL Hijacking
______________________________________________________________________________

1. Insecure Service Properties

If we can change the config of a service but not start/stop we cannot exploit it.


Step 1: Run winPEAS with serviceinfo or with accesschk and identify the vuln service

	winPEASany.exe quiet servicesinfo
	.\accesschk.exe /accepteula -uwcqv user daclsvc

Step 2: check the config with above service command.

step 3: Change the binary path of the service with our reverse shell.

step 4: Now start the service. we will get a reverse shell.

______________________________________________________________________________

2. Unquoted Service Path

C:\Program Files\Some Dir\SomeProgram.exe

In the Unquoted Service Path the C:\Program is the executable and remaining are aruments.
It will search each each possibility of the argument.  

Step 1: Run winPEAS with serviceinfo, identify the Unquoted Service Path vuln and confirm
	with service config.

Step 2: Check for write permissions in each folder in the path.

	.\accesschk.exe /accepteula -uwdq <path>

Step 3: Create a reverse shell file in the writeable folder with the same name that after ending with 
	the \.

Step 4: Now start the service. we will get a reverse shell.


______________________________________________________________________________






